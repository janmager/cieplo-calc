// export function getClimateZone(latitude: number, longitude: number) {
//     console.log(latitude, longitude)
//     // Strefa 5: Obszary górskie (Karpaty i Sudety)
//     // Karpaty (49.0°N - 49.7°N, 19.0°E - 22.0°E)
//     if (latitude >= 49.0 && latitude < 50.0 && longitude >= 19.0 && longitude <= 22.0) {
//         return 5;
//     }
//     // Sudety (50.0°N - 50.9°N, 15.0°E - 17.0°E)
//     if (latitude >= 50.0 && latitude < 51.0 && longitude >= 15.0 && longitude <= 17.0) {
//         return 5;
//     }

//     // Strefa 1: Wybrzeże Bałtyku
//     if (latitude >= 54.0 || (latitude >= 53.5 && longitude >= 14.0 && longitude <= 18.5)) {
//         return 1;
//     }

//     // Strefa 2: Niziny Zachodnie (szerzej: zachód od 18°E i szer. geogr. 51.0°N+)
//     if (latitude >= 51.0 && longitude < 18.0) {
//         return 2;
//     }

//     // Strefa 3: Polska Centralna (na wschód od 18°E)
//     if (longitude >= 18.0) {
//         return 3;
//     }

//     // Strefa 4: Wschód i Pogórze (południowy wschód, ale nie góry)
//     if (latitude >= 49.5) {
//         return 4;
//     }

//     return 5; // Domyślnie: strefa górska
// }


// Przykładowy plik GeoJSON (uproszczony, strefy przykładowe)

const climateZonesGeoJSON = {
    "type": "FeatureCollection",
    "features": [
      {
        "type": "Feature",
        "properties": {
          "zone": 3,
          "fill": "#ff7f00"
        },
        "geometry": {
          "coordinates": [
            [
              [
                [
                  14.85667478051019,
                  51.273127318036245
                ],
                [
                  14.658050886627535,
                  50.76197190581772
                ],
                [
                  16.617204749015457,
                  49.99045219810702
                ],
                [
                  18.594415329030085,
                  49.722705009071774
                ],
                [
                  19.44308105743707,
                  49.71686793710546
                ],
                [
                  20.58968262666957,
                  49.55314494574
                ],
                [
                  22.774545459378828,
                  49.52385076769144
                ],
                [
                  24.17394107537035,
                  50.41806654971302
                ],
                [
                  24.300338098750842,
                  50.961424249900745
                ],
                [
                  23.632239546599777,
                  51.683599262576706
                ],
                [
                  22.359240953987722,
                  51.96817835388143
                ],
                [
                  22.151588701292184,
                  52.08483580260639
                ],
                [
                  21.853652860468713,
                  52.603293559155674
                ],
                [
                  21.808511066404208,
                  53.191483035754544
                ],
                [
                  21.71822747827528,
                  53.315715922427984
                ],
                [
                  20.896646826305954,
                  53.40192612495423
                ],
                [
                  20.345916938722468,
                  53.428831056124295
                ],
                [
                  20.192434838904262,
                  53.51481249324203
                ],
                [
                  20.300775144658047,
                  54.47014460736645
                ],
                [
                  19.822272127577634,
                  54.47014460736645
                ],
                [
                  19.632676592506897,
                  54.14884720183315
                ],
                [
                  18.603443687842997,
                  53.1536013919733
                ],
                [
                  18.468018305649593,
                  52.94193377514287
                ],
                [
                  18.45898994683671,
                  52.49349233447094
                ],
                [
                  19.018748193233137,
                  51.76189807185233
                ],
                [
                  19.346945936458553,
                  51.508908742988694
                ],
                [
                  19.44308105743707,
                  51.06934126580046
                ],
                [
                  19.235428804741588,
                  50.984164494165896
                ],
                [
                  18.657613840719335,
                  50.93298328492733
                ],
                [
                  17.935345135691904,
                  50.97848047695905
                ],
                [
                  17.18599135422474,
                  50.881745689983745
                ],
                [
                  16.418580855132745,
                  50.955737448971405
                ],
                [
                  15.79562409704613,
                  51.10903687281572
                ],
                [
                  15.290036003527092,
                  51.278775189994604
                ],
                [
                  14.85667478051019,
                  51.273127318036245
                ]
              ]
            ]
          ],
          "type": "MultiPolygon"
        }
      },
      {
        "type": "Feature",
        "properties": {
          "zone": 4,
          "fill": "#6a3d9a"
        },
        "geometry": {
          "coordinates": [
            [
              [
                [
                  23.62657897687319,
                  51.686878775163905
                ],
                [
                  23.727258654965084,
                  51.835475321759276
                ],
                [
                  24.137721957952323,
                  52.61348173777438
                ],
                [
                  24.060276051728692,
                  53.05793681533126
                ],
                [
                  23.874405876790746,
                  53.41484862745318
                ],
                [
                  23.62657897687319,
                  53.75963426842574
                ],
                [
                  22.72046187405084,
                  53.6082751095808
                ],
                [
                  22.209318892971766,
                  53.640427063940365
                ],
                [
                  22.031193308656242,
                  53.809966486269815
                ],
                [
                  22.64301596782721,
                  54.36866898870534
                ],
                [
                  20.295037278085857,
                  54.444550507385316
                ],
                [
                  20.21121451239,
                  53.50706658334653
                ],
                [
                  20.35061714359324,
                  53.42407943771826
                ],
                [
                  20.89273848716215,
                  53.40099865453391
                ],
                [
                  21.705920502515113,
                  53.30855022439354
                ],
                [
                  21.8143447712294,
                  53.197347271126404
                ],
                [
                  21.822089361851,
                  52.92274319922734
                ],
                [
                  21.868556905585706,
                  52.58055235702972
                ],
                [
                  22.162851349237883,
                  52.06935715611942
                ],
                [
                  22.402933658532163,
                  51.9549552092777
                ],
                [
                  23.05347927081445,
                  51.806752862662734
                ],
                [
                  23.62657897687319,
                  51.686878775163905
                ]
              ]
            ],
            [
              [
                [
                  22.69695192157957,
                  49.523635714931345
                ],
                [
                  21.690988341626337,
                  49.52970980712513
                ],
                [
                  20.577410053121042,
                  49.563103825577855
                ],
                [
                  19.426400561639497,
                  49.71158177822471
                ],
                [
                  18.588877395074576,
                  49.72670714021487
                ],
                [
                  18.766675609205606,
                  49.459812178745466
                ],
                [
                  18.95851052445184,
                  49.35020674501439
                ],
                [
                  19.196187100534544,
                  49.4088907418232
                ],
                [
                  19.407684960151926,
                  49.47805596656653
                ],
                [
                  19.59016207465538,
                  49.441561596488356
                ],
                [
                  19.632272178001926,
                  49.429390766628245
                ],
                [
                  20.329428333411016,
                  49.36239721006436
                ],
                [
                  20.55401555126099,
                  49.35020674501439
                ],
                [
                  20.95172208287073,
                  49.24646577762755
                ],
                [
                  21.789245249435652,
                  49.24341126666707
                ],
                [
                  22.785851028645112,
                  48.89703377414372
                ],
                [
                  23.033832748355138,
                  48.94007888737363
                ],
                [
                  22.94025474091717,
                  49.33496441463723
                ],
                [
                  22.69695192157957,
                  49.523635714931345
                ]
              ]
            ]
          ],
          "type": "MultiPolygon"
        }
      },
      {
        "type": "Feature",
        "properties": {
          "zone": 1,
          "fill": "#1f78b4"
        },
        "geometry": {
          "coordinates": [
            [
              [
                [
                  14.498672908863682,
                  52.470233174926506
                ],
                [
                  14.941516083566853,
                  52.67486863999906
                ],
                [
                  15.285543012675078,
                  52.812236910410604
                ],
                [
                  16.061433533642173,
                  53.05489026519692
                ],
                [
                  16.74216766996267,
                  53.25241398534999
                ],
                [
                  17.93999571678657,
                  53.99817391557113
                ],
                [
                  18.742708583852192,
                  54.215303786904315
                ],
                [
                  19.01527719364023,
                  54.27182548796026
                ],
                [
                  19.0508561248285,
                  54.38429596898854
                ],
                [
                  18.991822284255534,
                  54.745303697375874
                ],
                [
                  18.150441358036403,
                  54.99237261800289
                ],
                [
                  16.027930083741182,
                  54.820126040698426
                ],
                [
                  13.967738310293328,
                  53.91803411870359
                ],
                [
                  14.115821459033526,
                  53.1734228217216
                ],
                [
                  13.985823911807898,
                  52.76161436992274
                ],
                [
                  14.498672908863682,
                  52.470233174926506
                ]
              ]
            ]
          ],
          "type": "MultiPolygon"
        }
      },
      {
        "type": "Feature",
        "properties": {
          "zone": 2,
          "fill": "#33a02c"
        },
        "geometry": {
          "coordinates": [
            [
              [
                [
                  19.822272127577634,
                  54.44915272884734
                ],
                [
                  19.27154223999318,
                  54.61678649135405
                ],
                [
                  19.100003422549122,
                  54.47539089487253
                ],
                [
                  19.018748193233137,
                  54.28082984020239
                ],
                [
                  17.935345135691904,
                  54.005831835105624
                ],
                [
                  16.734573413583064,
                  53.25634520571137
                ],
                [
                  16.617204749015457,
                  53.22392640053366
                ],
                [
                  15.967162914490075,
                  53.0343269547906
                ],
                [
                  15.37129123284214,
                  52.849342873212436
                ],
                [
                  14.78444791000706,
                  52.608772979140326
                ],
                [
                  14.387200122241751,
                  52.42197416808253
                ],
                [
                  14.450398633931982,
                  51.830607667519956
                ],
                [
                  14.838618062884393,
                  51.26747875174357
                ],
                [
                  15.335177797591541,
                  51.26747041863672
                ],
                [
                  15.79562409704613,
                  51.10903687281572
                ],
                [
                  16.436637572758542,
                  50.955737448971405
                ],
                [
                  17.222104789476305,
                  50.881745689983745
                ],
                [
                  17.948887673910747,
                  50.96993774460981
                ],
                [
                  18.684698917158073,
                  50.92728604176375
                ],
                [
                  19.253485522367328,
                  50.984164494165896
                ],
                [
                  19.44308105743707,
                  51.06934126580046
                ],
                [
                  19.352797469309138,
                  51.50974049740748
                ],
                [
                  19.018748193233137,
                  51.7730725484092
                ],
                [
                  18.477046664462506,
                  52.47699845190715
                ],
                [
                  18.477046664462506,
                  52.93649272655554
                ],
                [
                  18.612472046654887,
                  53.14818699806398
                ],
                [
                  19.298627316431777,
                  53.84102082077527
                ],
                [
                  19.641704951319724,
                  54.16470739239813
                ],
                [
                  19.822272127577634,
                  54.44915272884734
                ]
              ]
            ]
          ],
          "type": "MultiPolygon"
        }
      },
      {
        "type": "Feature",
        "properties": {
          "zone": 5,
          "fill": "#e31a1c"
        },
        "geometry": {
          "coordinates": [
            [
              [
                [
                  20.370075933442934,
                  49.36680381056385
                ],
                [
                  19.426715773730166,
                  49.4441387265679
                ],
                [
                  19.746121182136875,
                  49.08057795947701
                ],
                [
                  20.266083474892184,
                  49.163219862258074
                ],
                [
                  20.370075933442934,
                  49.36680381056385
                ]
              ]
            ],
            [
              [
                [
                  22.01306826770363,
                  53.80374185646559
                ],
                [
                  22.19664715968426,
                  53.62596311900816
                ],
                [
                  22.747383835624902,
                  53.60616352832457
                ],
                [
                  23.604085331533668,
                  53.744565750957065
                ],
                [
                  23.987932105674474,
                  54.05594328336218
                ],
                [
                  23.787664223513104,
                  54.25465863554575
                ],
                [
                  22.858643770159006,
                  54.52674030255167
                ],
                [
                  22.5582419469182,
                  54.31960366743135
                ],
                [
                  22.01306826770363,
                  53.80374185646559
                ]
              ]
            ]
          ],
          "type": "MultiPolygon"
        }
      }
    ]
  }
  
// Funkcja pomocnicza: sprawdza, czy punkt [lng, lat] (współrzędne w GeoJSON)
// leży wewnątrz pojedynczego ringu (tablica punktów [lng, lat])
function isPointInRing(lat: number, lng: number, ring: number[][]): boolean {
    let inside = false;
    for (let i = 0, j = ring.length - 1; i < ring.length; j = i++) {
      const xi = ring[i][0], yi = ring[i][1];
      const xj = ring[j][0], yj = ring[j][1];
      // Algorytm ray-casting – pamiętaj, że współrzędne GeoJSON są [lng, lat]
      if (((yi > lat) !== (yj > lat)) &&
          (lng < ((xj - xi) * (lat - yi)) / (yj - yi) + xi)) {
        inside = !inside;
      }
    }
    return inside;
  }
  
  // Funkcja pomocnicza: sprawdza, czy punkt leży w poligonie
  // polygon: tablica ringów (pierwszy ring to obwód zewnętrzny, kolejne to dziury)
  function isPointInPolygon(polygon: number[][][], lat: number, lng: number): boolean {
    // Jeśli punkt nie leży w obwodzie zewnętrznym, to nie jest wewnątrz poligonu
    if (!isPointInRing(lat, lng, polygon[0])) {
      return false;
    }
    // Jeśli punkt leży w którejkolwiek z dziur, to zwracamy false
    for (let i = 1; i < polygon.length; i++) {
      if (isPointInRing(lat, lng, polygon[i])) {
        return false;
      }
    }
    return true;
  }
  
  // Funkcja pomocnicza: sprawdza, czy punkt leży w MultiPolygon
  // multiPolygon: tablica poligonów (każdy poligon to tablica ringów)
  function isPointInMultiPolygon(multiPolygon: number[][][][], lat: number, lng: number): boolean {
    for (const polygon of multiPolygon) {
      if (isPointInPolygon(polygon, lat, lng)) {
        return true;
      }
    }
    return false;
  }
  
  // Główna funkcja – iteruje po wszystkich feature'ach w naszym geojson
  // i zwraca strefę klimatyczną (properties.zone) pierwszego, w którym punkt [lat, lng] się znajduje.
  export function getClimateZone(lat: any, lng: any) {
    // Iterujemy po wszystkich strefach klimatycznych zapisanych w climateZonesGeoJSON
    for (const feature of climateZonesGeoJSON.features) {
      const geometry: any = feature.geometry;
      if (geometry.type === 'MultiPolygon') {
        if (isPointInMultiPolygon(geometry.coordinates, lat, lng)) {
          return feature.properties.zone;
        }
      } else if (geometry.type === 'Polygon') {
        if (isPointInPolygon(geometry.coordinates, lat, lng)) {
          return feature.properties.zone;
        }
      }
    }
    return null; // jeśli punkt nie należy do żadnej strefy
  }
  
  
